{
    "title": "Calculator",
    
    "actions": {
        "calculate": {
            "input": {
                "type": "array",
                "items": {
                    "type": "number"
                },
                "minItems": 2,
                "maxItems": 2
            },
            "output": {
                "type": "number"
            },
            "uriVariables": {
                "operator": {
                    "type": "string",
                    "enum": [ "add", "subtract", "multiply", "divide" ]
                }
            }
        }
    },

    "dataMap": {
        "opMap": {
            "type": "object"
        }
    },

    "processes": {

        "init": {
            "triggers": [ { "runtimeEvent": "startup" } ],
            "instructions": [
                {
                    "move": {
                        "from": {
                            "compound": {
                                "add": "+",
                                "subtract": "-",
                                "multiply": "*",
                                "divide": "/"
                            }
                        },
                        "to": { "pointer": ["/dmap/opMap"] }
                    }
                }
            ]
        },

        "calc": {
            "triggers": [
                {
                    "runtimeEvent": "invokeAction",
                    "interactionAffordance": "calculate"
                }
            ],
            "instructions": [
                {
                    "try": {
                        "try": [
                            {
                                "move": {
                                    "from": {
                                        "expression": {
                                            "expr": ["${a/calculate/i/0}", 
                                                    "${dmap/opMap/${a/calculate/uv/operator}}",
                                                    "${a/calculate/i/1}"]
                                        }
                                    },
                                    "to": { "pointer": ["a/calculate/o"] }
                                }
                            }
                        ],
                        "catch": [
                            {
                                "move": {
                                    "from": { "compound": 0 },
                                    "to": { "pointer": ["a/calculate/o"] }
                                }
                            }
                        ]
                    }
                }
            ]
        }
    }
}
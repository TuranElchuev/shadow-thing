{    
    "title": "Consumer",

    "properties": {
        "testProp": {
            "type": "number",
            "processes": {
                "onWrite": {
                    "instructions": [
                        {
                            "move": {
                                "from": { "pointer": "../i" },
                                "to": { "pointer": "../o" }
                            }
                        }
                    ]
                }
            }
        }
    },

    "dataMap": {
        "remoteThing": {
            "type": "string",
            "default": "http://localhost:8081/Temperature"
        },        
        "obj": {
            "type": "object"
        },        
        "num": {
            "type": "number"
        }
    },

    "processes": {
        "test": {
            "triggers": [ { "runtimeEvent": "startup" } ],
            "instructions": [
                { "delay": "2s", "log": ["${dt/iso}   Writing 10 to own property testProp"] },                
                {
                    "writeProperty": {
                        "name": "testProp",
                        "value": { "compound": 10 }
                    }
                },
                { "delay": "2s", "log": ["${dt/iso}   Reading own property testProp"] },
                {
                    "readProperty": {
                        "name": "testProp",
                        "result": { "pointer": "/dmap/num" }
                    }
                },
                { "delay": "2s", "log": ["${dt/iso}   Read property value is: $p{dmap/num}"] },

                {
                    "delay": "2s",
                    "invokeAction": {
                        "webUri": ["${dmap/remoteThing}"],
                        "name": ["service"],
                        "input": { 
                            "compound": {
                                "op": "write",
                                "path": "/dmap/sampleInterval",
                                "content": {
                                    "val": 1000
                                }
                            }
                        },
                        "output": { "pointer": ["dmap/obj"] }
                    }
                },
                { "log": ["${dt/iso}   Acion result is: $p{dmap/obj}"] },
                
                {
                    "writeProperty": {
                        "webUri": ["${dmap/remoteThing}"],
                        "name": ["threshold"],
                        "value": { "compound": 40 }
                    }
                },
                
                {
                    "readProperty": {
                        "webUri": ["${dmap/remoteThing}"],
                        "name": ["threshold"],
                        "result": { "pointer": ["/dmap/num"] }
                    }
                },
                { "log": ["${dt/iso}   Read property value is: $p{dmap/num}"] },


                { "log": ["${dt/iso}   Subscribing to event"] },
                {
                    "subscribeEvent": {
                        "webUri": ["${dmap/remoteThing}"],
                        "name": ["overheat"],
                        "data": { "pointer": ["/dmap/obj"] },
                        "onEmit": [
                            { "log": ["${dt/iso}   Event result:",
                                        "\n$p{/dmap/obj}"] }
                        ]
                    }
                }
            ]
        }
    }
}